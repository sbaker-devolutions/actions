name: Semgrep

inputs:
  rules:
    description: Rules
    default: p/default
    required: true
  timeout:
    description: Timeout default 1800 seconds (30 minutes). Set to 0 to disable.
    default: 1800
    required: true
  
runs:
  using: composite
  container:
    image: returntocorp/semgrep

  steps:
    - uses: actions/checkout@v3

    - run: semgrep ci
      env:
        SEMGREP_RULES: ${{ github.event.inputs.rules }}
        SEMGREP_TIMEOUT: ${{ github.event.inputs.timeout }}
